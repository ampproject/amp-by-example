<!---{
  "preview": "default",
  "experiments": ["amp-form-var-sub"]
  }--->
  <!--
  #### Introduction

  This is a sample template for a poll in AMP. After selecting one of the answers, you will see the percentage of chosen answers.

-->
<!-- -->
<!doctype html>
<html âš¡>
<head>
<meta charset="utf-8">
<script async src="https://cdn.ampproject.org/v0.js"></script>
<!-- #### Setup -->
<!--
Import the additional AMP components. This sample uses a amp-form and mustache templates.
-->
<script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
<script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.1.js"></script>
<link rel="canonical" href="https://ampbyexample.com/samples_templates/poll/">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

<style amp-custom>
  #poll1 li {
            position: relative;
            padding: 1em;
            list-style: none;
            margin: 0;
            display: block;
            height: 20px;
        }
        #poll1.amp-form-submit-success fieldset {
            display: none;
        }
        .percentage-container {
            font-size: 0;
        }
        .one-pc {
            width: 1%;
            height: 80%;
            display: inline-block;
            background: #eb407a;
        }
        .results-table {
          display: flex;
          flex-wrap: wrap;
          margin: 0 0 3em 0;
          padding: 0;
        }
        .results-table-cell {
          box-sizing: border-box;
          flex-grow: 1;
          width: 100%;
          overflow: hidden;
          list-style: none;
          width: 25%;
        }


</style>
</head>
<body>

<h4 id="header1">Flightless bird poll</h4>
<!-- #### Poll -->
<!--
We use `amp-form` to realize a poll and the `CLIENT_ID` variable to identify the user,
this enables us to know if the user has already submitted an answer.
The `CLIENT_ID` variable can be used inside an amp-form by declaring an hidden input value with `default-value="CLIENT_ID(cart)`. Read more about variable substitution [here](https://github.com/ampproject/amphtml/blob/master/spec/amp-var-substitutions.md). -->

<form method="post" action-xhr="<%host%>/samples_templates/poll/submit" target="_blank"
      id="poll1"
      custom-validation-reporting="as-you-go">
    <input name="clientId" type="hidden" value="CLIENT_ID(poll)" data-amp-replace="CLIENT_ID">
    <fieldset>
        <p>What is your favorite flightless bird?</p>
        <p>Choose your favourite flightless bird and you will discover what other users have chosen.
        If you have already voted, your answer will be overwritten.</p>
        <ul>
          [[range $key, $value := .Questions]]
          <li>
              <label>
                  <input name="answer" value="[[$key]]" type="radio" on="change:poll1.submit">
                  [[$value]]
              </label>
          </li>
          [[end]]
        </ul>
    </fieldset>
    <div submit-success>
        <template type="amp-mustache">
            <p>{{Message}}</p>
            <p>Here are the results!</p>
            <div class="results-table">
              <div class="results-table-cell">
                <h5>Answer</h5>
              </div>
              <div class="results-table-cell">
                <h5>&nbsp;</h5>
              </div>
              <div class="results-table-cell">
                  <h5>&nbsp;</h5>
              </div>
              <div class="results-table-cell">
                <h5>Votes</h5>
              </div>
            {{#PollEntryResults}}
                <div class="results-table-cell">
                  <h5>{{Answer}}</h5>
                </div>
                <div class="results-table-cell">
                  <h5>{{Percentage.length}}%</h5>
                </div>
                <div class="percentage-container results-table-cell">
                    {{#Percentage}}<span class="one-pc"></span>{{/Percentage}}
                </div>
                <div class="results-table-cell">
                  <h5>{{Votes}}</h5>
                </div>
            {{/PollEntryResults}}

          </div>
        </template>
    </div>
    <div submit-error>
      <template type="amp-mustache">
        Error! Looks like something went wrong with your vote, please try to submit it again. {{error}}
      </template>
    </div>
</form>
</body>
</html>
