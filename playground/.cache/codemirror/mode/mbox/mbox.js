!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e){return"Subject"===e?"header":"string"}function n(e,n){if(e.sol()){if(n.inSeparator=!1,n.inHeader&&e.match(a))return null;if(n.inHeader=!1,n.header=null,e.match(o))return n.inHeaders=!0,n.inSeparator=!0,"atom";var t,i=!1;return(t=e.match(c))||(i=!0)&&(t=e.match(d))?(n.inHeaders=!0,n.inHeader=!0,n.emailPermitted=i,n.header=t[1],"atom"):n.inHeaders&&(t=e.match(m))?(n.inHeader=!0,n.emailPermitted=!0,n.header=t[1],"atom"):(n.inHeaders=!1,e.skipToEnd(),null)}if(n.inSeparator)return e.match(s)?"link":e.match(u)?"atom":(e.skipToEnd(),"atom");if(n.inHeader){var p=r(n.header);if(n.emailPermitted){if(e.match(f))return p+" link";if(e.match(l))return p}return e.skipToEnd(),p}return e.skipToEnd(),null}var t=["From","Sender","Reply-To","To","Cc","Bcc","Message-ID","In-Reply-To","References","Resent-From","Resent-Sender","Resent-To","Resent-Cc","Resent-Bcc","Resent-Message-ID","Return-Path","Received"],i=["Date","Subject","Comments","Keywords","Resent-Date"];e.registerHelper("hintWords","mbox",t.concat(i));var a=/^[ \t]/,o=/^From /,d=new RegExp("^("+t.join("|")+"): "),c=new RegExp("^("+i.join("|")+"): "),m=/^[^:]+:/,s=/^[^ ]+@[^ ]+/,u=/^.*?(?=[^ ]+?@[^ ]+)/,f=/^<.*?>/,l=/^.*?(?=<.*>)/;e.defineMode("mbox",function(){return{startState:function(){return{inSeparator:!1,inHeader:!1,emailPermitted:!1,header:null,inHeaders:!1}},token:n,blankLine:function(e){e.inHeaders=e.inSeparator=e.inHeader=!1}}}),e.defineMIME("application/mbox","mbox")});